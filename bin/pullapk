#!/bin/bash

# author: rochdi nassah
# created: 2025/09/21

# search=$(adb shell pm list packages|grep $1)

# if [ 0 == ${#search} ]
# then
#   echo package search for \"$1\" error
# fi

# package=$(echo $search | sed 's/package\://')

# paths=$(adb shell pm path $package)
# paths=(${paths// / })

# /usr/bin/mkdir ~/Desktop/apk/$1 &> /dev/null
# cd ~/Desktop/apk/$1

# for path in ${paths[@]}
# do
#   adb pull $(echo $path | sed 's/package\://')
# done

# apktool d base.apk -f -o source &&
# cd source &&
# cat AndroidManifest.xml

security_config='<?xml version="1.0" encoding="utf-8"?>
<network-security-config>
    <base-config cleartextTrafficPermitted="true">
        <trust-anchors>
            <certificates src="system" />
            <certificates src="user" />
        </trust-anchors>
    </base-config>
</network-security-config>'

cd ~/Desktop/apk/dofus/source

while read line
do
  if [[ $line =~ "<application" ]]
  then
    if [[ $line =~ android\:networkSecurityConfig=\"@xml\/([a-zA-Z0-9_-]+)\" ]]
    then
      config_filename=${BASH_REMATCH[1]}

      echo $config_filename
    fi
    break
  fi
done < AndroidManifest.xml